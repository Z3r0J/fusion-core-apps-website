---
import BaseLayout from "@/layouts/BaseLayout.astro";
import {
	ArrowRight,
	BriefcaseBusiness,
	CircleCheck,
	Mail,
	RefreshCcw,
	Send,
	Speech,
} from "lucide-react";
---

<BaseLayout
	description="Get in touch with FusionCore Apps. We'd love to hear from you for support, partnerships, or business inquiries."
	title="Contact Us ‚Äî FusionCore Apps"
>
	<div class="contact-page mx-auto max-w-7xl px-4 py-16 sm:px-6 lg:px-8">
		<!-- Page Header -->
		<div class="mb-16 text-center">
			<h1 class="mb-6 text-4xl font-bold text-gray-900 sm:text-5xl dark:text-white">
				Get In Touch
			</h1>
			<p class="mx-auto max-w-3xl text-xl leading-relaxed text-gray-600 dark:text-gray-400">
				We'd love to hear from you. Whether you have a question about our apps, need support, or
				want to discuss a potential partnership, our team is ready to help.
			</p>
		</div>

		<div class="grid gap-12 lg:grid-cols-3">
			<!-- Contact Information -->
			<div class="lg:col-span-1">
				<div class="space-y-8">
					<h2 class="mb-6 text-2xl font-bold text-gray-900 dark:text-white">Contact information</h2>

					<!-- Email -->
					<div class="flex items-start gap-4">
						<div
							class="flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-xl bg-gradient-to-br from-blue-500 to-blue-600"
						>
							<Mail className="h-6 w-6 text-white" />
						</div>
						<div>
							<h3 class="mb-1 font-semibold text-gray-900 dark:text-white">Email</h3>
							<a
								class="text-brand-600 dark:text-brand-400 hover:text-brand-700 dark:hover:text-brand-300 transition-colors"
								href="mailto:jeanrey.ese@gmail.com"
							>
								jeanrey.ese@gmail.com
							</a>
							<p class="mt-1 text-sm text-gray-600 dark:text-gray-400">
								We'll respond within 24 hours
							</p>
						</div>
					</div>

					<!-- Support -->
					<div class="flex items-start gap-4">
						<div
							class="flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-xl bg-gradient-to-br from-green-500 to-green-600"
						>
							<Speech className="h-6 w-6 text-white" />
						</div>
						<div>
							<h3 class="mb-1 font-semibold text-gray-900 dark:text-white">Support</h3>
							<p class="text-gray-600 dark:text-gray-400">
								For app-related issues and technical support
							</p>
							<a
								class="text-brand-600 dark:text-brand-400 hover:text-brand-700 dark:hover:text-brand-300 flex items-center text-sm transition-colors"
								href="mailto:jeanrey.ese@gmail.com?subject=App Support Request"
							>
								Get help <ArrowRight
									className="ml-1 size-4 transition-transform group-hover:translate-x-1"
								/>
							</a>
						</div>
					</div>

					<!-- Business -->
					<div class="flex items-start gap-4">
						<div
							class="flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-xl bg-gradient-to-br from-purple-500 to-purple-600"
						>
							<BriefcaseBusiness className="h-6 w-6 text-white" />
						</div>
						<div>
							<h3 class="mb-1 font-semibold text-gray-900 dark:text-white">Business inquiries</h3>
							<p class="text-gray-600 dark:text-gray-400">
								Partnerships, collaborations, and business opportunities
							</p>
							<a
								class="text-brand-600 dark:text-brand-400 hover:text-brand-700 dark:hover:text-brand-300 flex items-center text-sm transition-colors"
								href="mailto:jeanrey.ese@gmail.com?subject=Business Inquiry"
							>
								Let's talk <ArrowRight
									className="ml-1 size-4 transition-transform group-hover:translate-x-1"
								/>
							</a>
						</div>
					</div>
				</div>
			</div>

			<!-- Contact Form -->
			<div class="lg:col-span-2">
				<div class="card p-8">
					<h2 class="mb-6 text-2xl font-bold text-gray-900 dark:text-white">Send us a message</h2>

					<!-- Success/Error Messages -->
					<div class="mb-6 hidden" id="formMessages"></div>

					<form class="space-y-6" id="contactForm">
						<!-- Name and Email -->
						<div class="grid gap-4 sm:grid-cols-2 sm:gap-6">
							<div>
								<label class="label" for="name">Full name *</label>
								<input
									autocomplete="name"
									class="input"
									id="name"
									name="name"
									placeholder="John Doe"
									required
									type="text"
								/>
							</div>

							<div>
								<label class="label" for="email">Email address *</label>
								<input
									autocomplete="email"
									class="input"
									id="email"
									name="email"
									placeholder="john@example.com"
									required
									type="email"
								/>
							</div>
						</div>

						<!-- Subject -->
						<div>
							<label class="label" for="subject">Subject *</label>
							<select class="input" id="subject" name="subject" required>
								<option value="">Select a subject</option>
								<option value="app-support">üì± App support</option>
								<option value="bug-report">üêõ Bug report</option>
								<option value="feature-request">üí° Feature request</option>
								<option value="business-inquiry">üíº Business inquiry</option>
								<option value="partnership">ü§ù Partnership</option>
								<option value="general">üí¨ General question</option>
								<option value="other">üìù Other</option>
							</select>
						</div>

						<!-- App (if applicable) -->
						<div>
							<label class="label" for="app">Related app (optional)</label>
							<input
								class="input"
								id="app"
								name="app"
								placeholder="e.g., Bible TPT, Biblia TLA"
								type="text"
							/>
							<p class="mt-1 text-xs text-gray-500 dark:text-gray-400">
								If your message is about a specific app, please let us know which one.
							</p>
						</div>

						<!-- Message -->
						<div>
							<label class="label" for="message">Message *</label>
							<textarea
								class="input resize-y"
								id="message"
								name="message"
								placeholder="Tell us how we can help you..."
								required
								rows="6"></textarea>
						</div>

						<!-- Privacy Notice -->
						<div
							class="rounded-xl border border-blue-200 bg-gradient-to-r from-blue-50 to-indigo-50 p-4 dark:border-blue-800 dark:from-blue-900/20 dark:to-indigo-900/20"
						>
							<div class="flex items-start gap-3">
								<CircleCheck
									className="mt-0.5 h-5 w-5 flex-shrink-0 text-blue-600 dark:text-blue-400"
								/>
								<div class="text-sm text-blue-800 dark:text-blue-200">
									<p class="mb-1 font-medium">Privacy & data protection</p>
									<p>
										By submitting this form, you agree to our
										<a class="font-medium underline hover:no-underline" href="/privacy"
											>Privacy policy</a
										>. We'll only use your information to respond to your inquiry and will never
										share it with third parties.
									</p>
								</div>
							</div>
						</div>

						<!-- Submit Button -->
						<div
							class="flex flex-col-reverse items-stretch justify-end gap-3 pt-4 sm:flex-row sm:items-center sm:gap-4"
						>
							<button class="button button--secondary" type="reset">
								<RefreshCcw className="mr-2 h-4 w-4" />
								Clear form
							</button>
							<button class="button button--primary" id="submitButton" type="submit">
								<Send className="mr-2 h-4 w-4" />
								Send message
							</button>
						</div>
					</form>
				</div>
			</div>
		</div>

		<!-- FAQ Section -->
		<section class="mt-24 border-t border-gray-200 pt-16 dark:border-gray-800">
			<div class="mb-12 text-center">
				<h2 class="mb-4 text-3xl font-bold text-gray-900 dark:text-white">
					Frequently asked questions
				</h2>
				<p class="text-lg text-gray-600 dark:text-gray-400">
					Find quick answers to common questions about our apps and services.
				</p>
			</div>

			<div class="grid gap-6 md:grid-cols-2">
				<div class="card p-6">
					<h3 class="mb-3 text-lg font-semibold text-gray-900 dark:text-white">
						How do I download your apps?
					</h3>
					<p class="text-gray-600 dark:text-gray-400">
						All our apps are available on the Google Play Store. Simply visit our
						<a class="text-brand-600 dark:text-brand-400 hover:underline" href="/apps">apps page</a>
						and click on any app to be redirected to the Play Store for download.
					</p>
				</div>

				<div class="card p-6">
					<h3 class="mb-3 text-lg font-semibold text-gray-900 dark:text-white">
						Are your apps free?
					</h3>
					<p class="text-gray-600 dark:text-gray-400">
						Most of our apps are free to download and use. Some may offer premium features through
						in-app purchases. Check each app's details page for specific pricing information.
					</p>
				</div>

				<div class="card p-6">
					<h3 class="mb-3 text-lg font-semibold text-gray-900 dark:text-white">
						How do I report a bug or issue?
					</h3>
					<p class="text-gray-600 dark:text-gray-400">
						You can report bugs or issues by using the contact form above with "Bug Report" as the
						subject, or by leaving a review on the Google Play Store. We actively monitor and
						respond to all feedback.
					</p>
				</div>

				<div class="card p-6">
					<h3 class="mb-3 text-lg font-semibold text-gray-900 dark:text-white">
						Do you offer custom app development?
					</h3>
					<p class="text-gray-600 dark:text-gray-400">
						Yes! We offer custom mobile app development services. Please contact us with "Business
						Inquiry" as the subject to discuss your project requirements and get a quote.
					</p>
				</div>
			</div>
		</section>
	</div>
</BaseLayout>

<script>
	// Contact Form Logic
	document.addEventListener("DOMContentLoaded", () => {
		const form = document.getElementById("contactForm");
		if (!form) return;

		const submitButton = form.querySelector('button[type="submit"]');
		const messagesDiv = document.getElementById("formMessages");

		// Show notification
		function showMessage(message, type) {
			if (!messagesDiv) return;

			messagesDiv.className = `mb-6 rounded-lg p-4 ${
				type === "success"
					? "bg-green-50 text-green-800 border border-green-200 dark:bg-green-900/20 dark:text-green-400 dark:border-green-800"
					: "bg-red-50 text-red-800 border border-red-200 dark:bg-red-900/20 dark:text-red-400 dark:border-red-800"
			}`;
			messagesDiv.textContent = message;
			messagesDiv.classList.remove("hidden");

			setTimeout(() => {
				messagesDiv.classList.add("hidden");
			}, 5000);
		}

		// Handle form submission
		form.addEventListener("submit", async (e) => {
			e.preventDefault();

			if (submitButton) {
				submitButton.disabled = true;
				submitButton.innerHTML =
					'<svg class="animate-spin h-5 w-5 mr-2 inline-block" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" fill="none"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Sending...';
			}

			const nameInput = form.querySelector('[name="name"]');
			const emailInput = form.querySelector('[name="email"]');
			const subjectInput = form.querySelector('[name="subject"]');
			const appInput = form.querySelector('[name="app"]');
			const messageInput = form.querySelector('[name="message"]');

			const formData = {
				name: nameInput ? nameInput.value.trim() : "",
				email: emailInput ? emailInput.value.trim() : "",
				subject: subjectInput ? subjectInput.value.trim() : "",
				app: appInput ? appInput.value.trim() : "",
				message: messageInput ? messageInput.value.trim() : "",
			};

			try {
				const response = await fetch("/api/contact", {
					method: "POST",
					headers: {
						"Content-Type": "application/json",
					},
					body: JSON.stringify(formData),
				});

				const data = await response.json();

				if (!response.ok) {
					throw new Error(data.error || "Failed to send message");
				}

				showMessage("‚úÖ Message sent successfully! We'll get back to you soon.", "success");
				form.reset();
			} catch (error) {
				console.error("Form submission error:", error);
				showMessage("‚ùå Failed to send message. Please try again or email us directly.", "error");
			} finally {
				if (submitButton) {
					submitButton.disabled = false;
					submitButton.innerHTML =
						'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2 h-4 w-4 inline-block"><path d="m22 2-7 20-4-9-9-4Z"/><path d="M22 2 11 13"/></svg> Send message';
				}
			}
		});
	});
</script>
