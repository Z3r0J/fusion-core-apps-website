---
import type { CollectionEntry } from "astro:content";
const { app } = Astro.props as { app: CollectionEntry<"apps"> };

const structuredData = {
	"@context": "https://schema.org",
	"@type": "MobileApplication",
	"name": app.data.title,
	"operatingSystem": "Android",
	"applicationCategory": app.data.category,
	"description": app.data.description,
	"url": new URL(`/apps/${app.slug}`, Astro.site).href,
	"downloadUrl": app.data.playUrl,
	"image": app.data.icon ? new URL(app.data.icon, Astro.site).href : undefined,
	...(app.data.version ? { softwareVersion: app.data.version } : {}),
	"offers": {
		"@type": "Offer",
		"price": app.data.price === "Free" ? "0" : app.data.price,
		"priceCurrency": "USD",
	},
	"publisher": { "@type": "Organization", "name": "FusionCore Apps" },
};
---

<!-- eslint-disable astro/no-set-html-directive -->
<script
	is:inline
	set:html={JSON.stringify(structuredData).replace(/</g, "\\u003c")}
	type="application/ld+json"
></script>
